#!/bin/sh

# Shows disk usage.
# For dwm/st status bar, compatible with Arch Linux Nerd Fonts rendering

case $BUTTON in
	1) notify-send "󰋊 Disk hogs" "$(du -sh /home/* 2>/dev/null | sort -rh | head -10)" ;;
	2) setsid -f "$TERMINAL" -e ncdu "/" ;;
	3) notify-send "󰋊 Disk module" "\- Shows disk usage" ;;
	6) "$TERMINAL" -e "$EDITOR" "$0" ;;
esac

disk_info=$(df -P / 2>/dev/null | sed -n '2{p;q}')
[ -z "$disk_info" ] && echo "󰋊" && exit 1

echo "$disk_info" | awk '{
    used = $3
    total = $2
    pct = int(used * 100 / total)
    printf ("%d%%󰋊\n", pct)
}'
